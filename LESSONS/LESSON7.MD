### üîô üìö üîú –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫—É—Ä—Å—É

| [–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ](../LESSONS/PR5.MD) | &nbsp; | [–°–ª–µ–¥—É—é—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ](../LESSONS/PR6.MD) |
|:--------------------------------------:|:------:|:-------------------------------------:|
| üè† [–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Ññ5](../LESSONS/PR5.MD) | üìñ [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](../README.MD) | üíª [–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Ññ6](../LESSONS/PR6.MD) |

---
# üéì –õ–µ–∫—Ü–∏—è 6. –ò–Ω–¥–µ–∫—Å—ã: –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ, –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ, –ø–æ–∫—Ä—ã—Ç–∏—è
---


‚è±Ô∏è **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 90 –º–∏–Ω—É—Ç  
üéØ **–¶–µ–ª—å –ª–µ–∫—Ü–∏–∏**:  
–ù–∞—É—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ–Ω–∏–º–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ SQL Server, —Ä–∞–∑–ª–∏—á–∞—Ç—å **–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ** –∏ **–Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**, –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å **–ø–æ–∫—Ä—ã–≤–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã** —Å `INCLUDE`, –∏ —É—Å—Ç—Ä–∞–Ω—è—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —Ç–∞–∫–∏–µ –∫–∞–∫ **¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª** (Key Lookup).

---

### üìñ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤ (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏–∑ —Ä—É—Å—Å–∫–æ–π SSMS)

> üí° **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É –∫–∞–∫ —à–ø–∞—Ä–≥–∞–ª–∫—É** ‚Äî –≤—Å–µ —Ç–µ—Ä–º–∏–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É SSMS.

| –†—É—Å—Å–∫–∏–π —Ç–µ—Ä–º–∏–Ω (–≤ SSMS) | –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç | –ß—Ç–æ —ç—Ç–æ? |
|-------------------------|------------------------|----------|
| **–ò–Ω–¥–µ–∫—Å** | Index | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞. |
| **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** | Clustered Index | –ò–Ω–¥–µ–∫—Å, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ (—Ç–æ–ª—å–∫–æ 1 –Ω–∞ —Ç–∞–±–ª–∏—Ü—É). |
| **–ù–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** | Nonclustered Index | –û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—É–∫–∞–∑–∞—Ç–µ–ª—å (–¥–æ 999 –Ω–∞ —Ç–∞–±–ª–∏—Ü—É). |
| **–ö—É—á–∞** | HEAP | –¢–∞–±–ª–∏—Ü–∞ –±–µ–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞. |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã** | Table Scan | –ü–æ–ª–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∫—É—á–∏. |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–æ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞** | Clustered Index Scan | –ü–æ–ª–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã. |
| **–ü–æ–∏—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞** | Clustered Index Seek | –¢–æ—á–µ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É. |
| **–ü–æ–∏—Å–∫ –≤ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∏–Ω–¥–µ–∫—Å–µ** | Nonclustered Index Seek | –¢–æ—á–µ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É. |
| **–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã** | Key Lookup | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –¥–∞–Ω–Ω—ã–º –¥–ª—è ¬´–¥–æ–±–æ—Ä–∞¬ª —Å—Ç–æ–ª–±—Ü–æ–≤. |
| **–£—Ç–æ—á–Ω—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å RID (–∫—É—á–∞)** | RID Lookup | Key Lookup –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã-–∫—É—á–∏. |
| **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** | Sort | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ (–¥–æ—Ä–æ–≥–æ!). |
| **–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è** | logical reads | –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü (–ø–æ 8 –ö–ë) –ø—Ä–æ—á–∏—Ç–∞–Ω–æ –∏–∑ –ø–∞–º—è—Ç–∏. |
| **–∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è** | elapsed time | –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (¬´–ø–æ —á–∞—Å–∞–º¬ª). |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å: XX%** | Cost % | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ ¬´–¥–æ—Ä–æ–≥–æ–≤–∏–∑–Ω—ã¬ª –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –ø–ª–∞–Ω–∞. |

> üîç **–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ: ¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª**  
> ‚Äî –ü–æ—è–≤–ª—è—é—Ç—Å—è, –∫–æ–≥–¥–∞ –≤ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∏–Ω–¥–µ–∫—Å–µ **–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ `SELECT`**,  
> ‚Äî –í –ø–ª–∞–Ω–µ –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å –¥–≤—É–º—è –≤—Ö–æ–¥–∞–º–∏,  
> ‚Äî –ß–∞—Å—Ç–æ –∏–º–µ—é—Ç **–≤—ã—Å–æ–∫—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å (70‚Äì90%)** ‚Üí –Ω—É–∂–Ω–æ —É—Å—Ç—Ä–∞–Ω—è—Ç—å.

---

### 1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –∏–Ω–¥–µ–∫—Å—ã? –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

üîç **–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ**:  
–¢–∞–±–ª–∏—Ü–∞ `Students` ‚Äî **10 000 —Å—Ç—Ä–æ–∫**, –±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤ ‚Üí **–∫—É—á–∞**.  
–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≥—Ä—É–ø–ø—ã **¬´–ò–°-22¬ª**.

‚û°Ô∏è –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ SQL Server –¥–µ–ª–∞–µ—Ç **¬´–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã¬ª** ‚Äî —á–∏—Ç–∞–µ—Ç –≤—Å–µ 10 000 —Å—Ç—Ä–æ–∫.  
‚Üí `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è = 132` ‚Üí **1.03 –ú–ë –¥–∞–Ω–Ω—ã—Ö** –∑–∞ –∑–∞–ø—Ä–æ—Å.

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º **–Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å**:
```sql
CREATE NONCLUSTERED INDEX IX_Students_Group 
ON Students(GroupCode);
```

‚û°Ô∏è –ü–æ—è–≤–ª—è–µ—Ç—Å—è ¬´–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ¬ª:  
```
¬´–ò–°-22¬ª ‚Üí —Å—Ç—Ä–æ–∫–∏ ‚Ññ 1, 3, 7, ...
```

–ù–æ! –í –∏–Ω–¥–µ–∫—Å–µ ‚Äî —Ç–æ–ª—å–∫–æ `GroupCode` –∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–æ–∫—É.  
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å:
```sql
SELECT FullName, Email FROM Students WHERE GroupCode = '–ò–°-22';
```
‚Üí SQL Server –Ω–∞–π–¥—ë—Ç —Å—Ç—Ä–æ–∫–∏ –ø–æ –∏–Ω–¥–µ–∫—Å—É, –Ω–æ **–¥–æ–±–µ—Ä—ë—Ç `FullName`, `Email` —á–µ—Ä–µ–∑ ¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª**.

üí° **–ò–Ω–¥–µ–∫—Å** ‚Äî —ç—Ç–æ **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**, —É—Å–∫–æ—Ä—è—é—â–∞—è –ø–æ–∏—Å–∫, –Ω–æ —Ç—Ä–µ–±—É—é—â–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø–∏—Å–∏.

---

### 2. –î–≤–∞ –≤–∏–¥–∞ –∏–Ω–¥–µ–∫—Å–æ–≤: –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π

| –¢–∏–ø | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç | –ú–∞–∫—Å–∏–º—É–º |
|-----|--------------|----------|
| **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** | –§–∏–∑–∏—á–µ—Å–∫–∏ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∫–∞–∫ –∫–Ω–∏–≥–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É) | **1** |
| **–ù–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** | –•—Ä–∞–Ω–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äî –∫–∞–∫ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ: ¬´–∑–Ω–∞—á–µ–Ω–∏–µ ‚Üí —É–∫–∞–∑–∞—Ç–µ–ª—å¬ª | **999** |

üìå **–ê–Ω–∞–ª–æ–≥–∏—è**:  
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** = —Å–∞–º–∞ –∫–Ω–∏–≥–∞, –ø–µ—Ä–µ–ø–ª–µ—Ç—ë–Ω–Ω–∞—è –ø–æ —Ñ–∞–º–∏–ª–∏—è–º,  
- **–ù–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å** = –∑–∞–∫–ª–∞–¥–∫–∞-—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–æ–ª—è—Ö.

‚ùó **–í–∞–∂–Ω–æ**:  
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `PRIMARY KEY` –±–µ–∑ —É—Ç–æ—á–Ω–µ–Ω–∏—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è **–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å**.  
- –ï—Å–ª–∏ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–∫—É—á–µ–π**.

---

### 3. –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å?

–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ **B-–¥–µ—Ä–µ–≤–æ** (*Balanced Tree*):  
- **–õ–∏—Å—Ç—å—è** ‚Äî –ø–æ–ª–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö,  
- **–í–µ—Ä—Ö–Ω–∏–µ —É—Ä–æ–≤–Ω–∏** ‚Äî –∫–∞–∫ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ: ¬´–ê‚Äì–ì ‚Üí –ª–∏—Å—Ç 1¬ª, ¬´–î‚Äì–ö ‚Üí –ª–∏—Å—Ç 2¬ª.

üîß –ü—Ä–∏–º–µ—Ä:
```sql
ALTER TABLE Students 
ADD CONSTRAINT PK_Students PRIMARY KEY CLUSTERED (StudentID);
```

‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è:  
- `WHERE StudentID = 5` ‚Üí **¬´–ü–æ–∏—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞¬ª**,  
- `ORDER BY StudentID` ‚Üí —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

### 4. ¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª ‚Äî –≥–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–î–æ–ø—É—Å—Ç–∏–º, –∏–Ω–¥–µ–∫—Å:
```sql
CREATE NONCLUSTERED INDEX IX_Students_Group 
ON Students(GroupCode);
```

–ó–∞–ø—Ä–æ—Å:
```sql
SELECT FullName, Email 
FROM Students 
WHERE GroupCode = '–ò–°-22';
```

–í **¬´–ü–ª–∞–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è¬ª** –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã (0%)  
‚îú‚îÄ –ü–æ–∏—Å–∫ –≤ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∏–Ω–¥–µ–∫—Å–µ [IX_Students_Group] (19%)  
‚îî‚îÄ –£—Ç–æ—á–Ω—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å RID (–∫—É—á–∞) [Students] (81%)
```

üîç **–ü–æ—á–µ–º—É 81%?**  
- –ò–Ω–¥–µ–∫—Å –±—ã—Å—Ç—Ä–æ –Ω–∞—à—ë–ª 3300 —Å—Ç—Ä–æ–∫ ¬´–ò–°-22¬ª (**19%**),  
- –ù–æ –¥–ª—è –∫–∞–∂–¥–æ–π ‚Äî —Å–¥–µ–ª–∞–ª **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –∫—É—á—É** –∑–∞ `FullName`, `Email` (**81%**),  
- –≠—Ç–æ **—Å–ª—É—á–∞–π–Ω—ã–µ —á—Ç–µ–Ω–∏—è** ‚Äî –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ.

‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã —á–µ—Ä–µ–∑ `INCLUDE`.

---

### 5. –ü–æ–∫—Ä—ã–≤–∞—é—â–∏–π –∏–Ω–¥–µ–∫—Å ‚Äî –∫–∞–∫ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç ¬´–í–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤¬ª

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞:
```sql
WHERE GroupCode = '–ò–°-22' AND StudentID < 10
SELECT FullName, Email, AvgScore
```

‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!):
```sql
CREATE INDEX IX_Wrong ON Students(GroupCode) INCLUDE (StudentID, ...);
```
‚Üí `StudentID` –≤ `INCLUDE` ‚Äî –µ–≥–æ –Ω–µ–ª—å–∑—è —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å ‚Üí SQL Server –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å.

‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
```sql
CREATE NONCLUSTERED INDEX IX_Good 
ON Students(GroupCode, StudentID)  -- ‚Üê –æ–±–∞ —Å—Ç–æ–ª–±—Ü–∞ –∏–∑ WHERE!
INCLUDE (FullName, Email, AvgScore);  -- ‚Üê —Ç–æ–ª—å–∫–æ SELECT
```

‚Üí –í –ø–ª–∞–Ω–µ: —Ç–æ–ª—å–∫–æ **¬´–ü–æ–∏—Å–∫ –≤ –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∏–Ω–¥–µ–∫—Å–µ¬ª**,  
‚Üí **¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª –∏—Å—á–µ–∑–ª–∏**,  
‚Üí `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è` ‚Üì —Å 132 –¥–æ 3.

üìå **–ü—Ä–∞–≤–∏–ª–æ**:  
- –°—Ç–æ–ª–±—Ü—ã –∏–∑ `WHERE`, `ORDER BY` ‚Üí –≤ **–∫–ª—é—á –∏–Ω–¥–µ–∫—Å–∞**,  
- –°—Ç–æ–ª–±—Ü—ã —Ç–æ–ª—å–∫–æ –∏–∑ `SELECT` ‚Üí –≤ **`INCLUDE`**.

---

### 6. –ü–æ—á–µ–º—É ¬´–°—Ç–æ–∏–º–æ—Å—Ç—å: 100%¬ª –Ω–µ –∑–Ω–∞—á–∏—Ç ¬´–ø–ª–æ—Ö–æ¬ª?

> üí° **–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ % ‚Äî —ç—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –ø–ª–∞–Ω–∞**, –∞ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –º–µ—Ä–∞.

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ü–ª–∞–Ω | –°—Ç–æ–∏–º–æ—Å—Ç—å | `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è` |
|---------|------|-----------|------------------------------|
| –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ | ¬´–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã¬ª | 100% | 132 |
| –° –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º | ¬´–ü–æ–∏—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞¬ª | 100% | 2 |

‚û°Ô∏è –í –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö ‚Äî **100%**, –Ω–æ –≤—Ç–æ—Ä–æ–π –≤ **66 —Ä–∞–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ**.

‚úÖ **–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞**:  
- `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è`,  
- `–∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è`,  
- —Ç–∏–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (`Seek` –ª—É—á—à–µ `Scan`).

---

### 7. –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è 132? –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞—Å—á—ë—Ç

- 10 000 —Å—Ç—Ä–æ–∫ √ó ~131 –±–∞–π—Ç/—Å—Ç—Ä–æ–∫–∞ = **1.25 –ú–ë –¥–∞–Ω–Ω—ã—Ö**,  
- 1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞ = 8 –ö–ë ‚Üí **160 —Å—Ç—Ä–∞–Ω–∏—Ü**,  
- –ù–æ –¥–∞–Ω–Ω—ã–µ —É–ø–∞–∫–æ–≤–∞–Ω—ã –ø–ª–æ—Ç–Ω–µ–µ ‚Üí **132 —Å—Ç—Ä–∞–Ω–∏—Ü—ã**,  
- ‚Üí **132 –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è = 132 √ó 8 –ö–ë = 1.03 –ú–ë**.

‚úÖ –ü–æ—Å–ª–µ –ø–æ–∫—Ä—ã–≤–∞—é—â–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞: **3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã** = 24 –ö–ë ‚Üí –≤ **44 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ**.

---

### 8. –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

1. –ü–æ—á–µ–º—É –Ω–∞ —Ç–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å**?  
2. –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç **81% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É ¬´–£—Ç–æ—á–Ω—è—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ RID¬ª**?  
3. –ü–æ—á–µ–º—É –∏–Ω–¥–µ–∫—Å –ø–æ `(GroupCode)` **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**, –∞ –ø–æ `(GroupCode, StudentID)` ‚Äî **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**?  
4. –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É **–∫–ª—é—á–æ–º –∏–Ω–¥–µ–∫—Å–∞** –∏ **INCLUDE-—Å—Ç–æ–ª–±—Ü–∞–º–∏**?  
5. –ì–¥–µ –∏—Å–∫–∞—Ç—å `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è` ‚Äî –∏ –ø–æ—á–µ–º—É –∏—Ö –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å?

---

### 9. –ü–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤

‚úÖ **–ì–ª–∞–≤–Ω–æ–µ ‚Äî –∑–∞–ø–æ–º–Ω–∏—Ç–µ**:  
- **¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª = Key Lookup** ‚Äî —É–∑–∫–æ–µ –º–µ—Å—Ç–æ,  
- **¬´–£—Ç–æ—á–Ω—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å RID (–∫—É—á–∞)¬ª** ‚Äî –¥–æ—Ä–æ–∂–µ **¬´–ü–æ–∏—Å–∫–∞ –≤ –∏–Ω–¥–µ–∫—Å–µ¬ª**,  
- **–°—Ç–æ–∏–º–æ—Å—Ç—å: 100%** ‚Äî –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ, –µ—Å–ª–∏ `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è` –º–∞–ª—ã,  
- **–ü–æ–∫—Ä—ã–≤–∞—é—â–∏–π –∏–Ω–¥–µ–∫—Å** = –∫–ª—é—á –¥–ª—è –≤—Å–µ–≥–æ `WHERE` + `INCLUDE` –¥–ª—è `SELECT`.

üîú **–î–∞–ª–µ–µ**:  
–í **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ6** –≤—ã:  
- —Å–æ–∑–¥–∞–¥–∏—Ç–µ –∏–Ω–¥–µ–∫—Å—ã,  
- —É–≤–∏–¥–∏—Ç–µ **¬´–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã¬ª (81%)**,  
- —É—Å—Ç—Ä–∞–Ω–∏—Ç–µ –∏—Ö —Å –ø–æ–º–æ—â—å—é `INCLUDE`,  
- –∏–∑–º–µ—Ä–∏—Ç–µ, –∫–∞–∫ `–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è` —É–ø–∞–¥—É—Ç —Å **132 –¥–æ 3**.

---

üìé **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
|---------|---------|
| –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å | `ALTER TABLE T ADD CONSTRAINT PK PRIMARY KEY CLUSTERED (col);` |
| –°–æ–∑–¥–∞—Ç—å –Ω–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å | `CREATE NONCLUSTERED INDEX IX_Name ON T(col);` |
| –ü–æ–∫—Ä—ã–≤–∞—é—â–∏–π –∏–Ω–¥–µ–∫—Å | `CREATE NONCLUSTERED INDEX IX_Name ON T(col1, col2) INCLUDE (col3, col4);` |
| –í–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É | `SET STATISTICS IO, TIME ON;` |
| –í–∫–ª—é—á–∏—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | `Ctrl + M` ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å |

---

üìú **–õ–∏—Ü–µ–Ω–∑–∏—è**: [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/)  
üë®‚Äçüè´ **–ê–≤—Ç–æ—Ä**: –†—É—Å–ª–∞–Ω –†–∏–Ω–∞—Ç–æ–≤–∏—á –°–∞—Ñ–∏—É–ª–∏–Ω  
üìÖ **–î–∞—Ç–∞**: 14.11.2025  

---

### üîô üìö üîú –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫—É—Ä—Å—É

| [–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ](../LESSONS/PR5.MD) | &nbsp; | [–°–ª–µ–¥—É—é—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ](../LESSONS/PR6.MD) |
|:--------------------------------------:|:------:|:-------------------------------------:|
| üè† [–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Ññ5](../LESSONS/PR5.MD) | üìñ [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](../README.MD) | üíª [–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Ññ6](../LESSONS/PR6.MD) |

---
